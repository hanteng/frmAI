---
tags:
- 數據導向
- 機率性關聯
- 機器學習模型
- 向量空間
- 推薦系統
- 特徵工程
- 數據科學
- 線性代數
- 矩陣分解
- 特徵學習
---
::: {.callout-warning #nte--ed-index title="✎ 編輯筆記" collapse=true open=false}
- [x] 逐句**事實查核**
- [x] 檢視**邏輯流程**    
- [ ] 確保**精簡易懂**的文字風格    
- [x] 檢查**內部連結**：所有相關條目是否已連結    
- [ ] 檢查**外部連結**：來源
- [x] 確認導航區塊：.callout-tipx1 .callout-impx1 .callout-notex1 .callout-warning
:::
# 🚿協同過濾🤝 {#sec-collaborative-filtering}

`協同過濾`（Collaborative Filtering, CF），是種 **[機器學習模型](04-05-machine_learning_models.zh-hant)** ，主要應用於**推薦系統**，基於「人以群分，物以類聚」的原則。它依據**用戶行為的相似性**來發掘潛在的用戶群體或項目類別，進行**推薦**、**配對**、**分類**、等決策或預測。由於協同過濾高度依賴大量用戶行為數據，因此是**數據驅動**的 **[特徵工程](04-04-feature_engineering.zh-hant)**。

從人工智能應用的角度來看，`協同過濾`可以被視為一種 **[數據導向](05-02-oriented_data.zh-hant)** 的**心智框架**，專注於發現**關聯性**與**相似度**。此框架能基於大量**互動數據**（如評分、點擊、購買記錄等），來實現**推薦**、**配對**、**分類**等任務。

`協同過濾` 可被視為一種**數據驅動的推薦框架**，其核心思想是：

> 根據**用戶行為的相似性**，找出「與你相似的人喜歡什麼」，再將這些項目**推薦**給你。

助讀者快速抓住協同過濾的直觀 _數學表達_ 來說，是用**矩陣近似問題**仿擬**用戶行為的相似性**，支持推薦評分的計算。換言之，協同過濾就是透過「隱含因子空間」來推斷**尚未觀察到的偏好**，並將「與你相似的人喜歡的東西」推薦給你。

## 🚀 應用場景

協同過濾在多種場景中表現出色：

- 🛍️ **電子商務**：推薦用戶可能感興趣的商品，例如亞馬遜、淘寶的「購買此商品的顧客也買了...」。
- 🌐 **社群網路**：推薦可能感興趣的朋友、內容或群組。
- 💞 **匹配應用**：如婚戀交友、職業匹配等。
- 📺 **影音串流平台**：推薦電影、電視劇，例如 Netflix 的推薦引擎。
- 🎶 **音樂服務**：推薦用戶可能喜歡的歌曲或專輯，例如 Spotify 的「每日推薦」。
- 📰 **新聞與內容平台**：根據閱讀歷史推薦個性化的新聞文章或部落格。

這些應用領域的共同特點是數據量龐大，且需要高效、個性化的精準推薦。協同過濾能夠**有效挖掘潛在模式**。

::: {.callout-note #nte-math-collaborative-filtering title="~🚿協同過濾🤝~" collapse=false open=true }
- 🚀 **應用場景**  
  - 🛍️ 電子商務：商品推薦；
  - 🌐 社群網路：朋友、內容或群組推薦  
  - 💞 匹配應用：婚戀交友、職業配對  
  - 📺 影音串流：電影、影集推薦（Netflix 等）  
  - 🎶 音樂服務：歌曲、專輯推薦（Spotify 等）  
  - 📰 新聞與內容平台：依閱讀歷史推薦文章  

- 🔬 **細說**  
  - 📦 **資料層**：用戶歷史行為（購買、點擊、評分）數據建模依據  
  - 📐 **數學層**：  
    * 🧹🧩 **[線性代數](09-04-sparse_modeling.zh-hant)**：處理稀疏矩陣、計算相似度  
    * 🌀🎲🌿 **[機率模型](04-01-probabilistic_association.zh-hant)**：捕捉用戶與項目間的潛在關聯  
    * 🌀🌌▦ **[向量空間](04-07-vector_space.zh-hant.md)**：將關聯性映射為幾何相似度  
    * 🌀🛠️🤏 **[特徵工程](04-04-feature_engineering.zh-hant.md)**：進行分類、預測或項目分析  

:::


## 🔬 細說

協同過濾的運作基礎在於**行為數據的結構化表徵**與**相似性分析**。

- 📦在**資料層**，特別是**數據庫**，用戶的歷史行為（如購買、點擊、評分）被轉換為矩陣形式，成為後續建模的依據。    
- 📐 在**數學層**，🧹🧩 **[線性代數](09-04-sparse_modeling.zh-hant)** 用於處理稀疏矩陣並計算相似度；🌀🎲🌿 **[機率模型](04-01-probabilistic_association.zh-hant)** 則捕捉用戶與項目之間的潛在關聯；🌀🌌▦ **[向量空間](04-07-vector_space.zh-hant.md)** 提供了相似度運算的幾何詮釋。

如此一來，透過機器學習的🌀🛠️🤏 **[特徵工程](04-04-feature_engineering.zh-hant.md)**，對使用者的行為或偏好進行分類或預測，或對項目（如產品或服務）進行分析。

### 🤝結構與定義▦ 

協同過濾的核心在於如何表徵「用戶–項目」關係，常見矩陣包括：

1. 👤📦 **用戶–項目評分矩陣**（User-Item Rating Matrix）：記錄用戶對各項目的互動或評分。    
2. 👤👤 **用戶–用戶相似度矩陣**（User-User Similarity Matrix）：量化不同用戶之間的相似程度。    

這些矩陣的建立通常基於使用者的歷史行為數據（例如購買記錄、觀看紀錄、點讚等），再透過**特徵工程**進行分析、分類或預測。

### 🤝 協同過濾分類🚿

協同過濾可分為兩大類，皆以相似性為核心：

1. 👤 **基於用戶的協同過濾**（User-Based CF）
    - 🔍 **尋找相似用戶**：計算目標用戶與其他用戶之間的相似度，找出「鄰居」用戶群。        
    - 👍 **生成推薦**： 推薦鄰居喜歡但目標用戶尚未接觸的項目。        
2. 📦 **基於物品的協同過濾**（Item-Based CF）
    - 🔍 **尋找相似物品**：計算物品之間的相似度（例如根據所有用戶對它們的評分模式），找出與目標用戶已互動項目相似的其他項目。        
    - 👍 **生成推薦**：對於目標用戶喜歡的物品，找出與其最相似的其他物品並推薦。

### 📐 線性代數支撐🧮

`協同過濾`的強大之處，源於其深厚的**線性代數**根基：

- ▦ **用戶-物品矩陣**：以矩陣 $R$ 表徵用戶與物品的互動關係，每個元素 $R_{ui}$ 代表一個行為或評分。
- 📐 **相似度計算**：透過向量運算（如餘弦相似度、皮爾遜相關係數）衡量「用戶–用戶」或「物品–物品」之間的相似性。
- ⛓‍💥 **矩陣分解**：將稀疏矩陣 $R$ 分解為低維矩陣 $P$ 與 $Q$，以捕捉潛在因子並重建偏好模式。
- 👍 **預測評分**：利用 $P_u$ 與 $Q_i$ 的內積，估計用戶 $u$ 對物品 $i$ 的潛在評分 $\hat{R}_{ui}$。

因此，在實踐時，通常可利用如 Python 的張量運算工作流（tensor workflow），使用 **torch** 等模組，經訓練算出：

- ▦ **準備用戶-物品矩陣構建**：將互動數據（評分、點擊、購買）轉換為張量 $R$，行代表用戶，列代表物品。
- 📐 **計算相似度**：對行向量（用戶–用戶）或列向量（物品–物品）計算餘弦相似度或皮爾遜相關係數，衡量相似性。
- ⛓‍💥 **嵌入式矩陣分解**：建立**用戶嵌入矩陣** $P$ 與**物品嵌入矩陣** $Q$，透過梯度下降學習潛在因子，使 $R \approx P Q^T$。
- 🔄 **訓練迴圈**：定義損失函數（如 MSE），在已知評分上最小化 $\|R - P Q^T\|$，並透過反向傳播更新參數。
- 👍 **生成推薦**：計算 $\hat{R} = P Q^T$，對每位用戶排序尚未互動的物品預測分數，輸出 Top-N 推薦清單。

讀者可以上述流程進行實踐，或深入其數學原理，見下面要點說明框：

::: {.callout-important #imp-math-collaborative-filtering title="🚿協同過濾🤝~ 線性代數支撐" collapse=false open=true }

線性代數支撐 `協同過濾` 的相關矩陣表達及計算如下述：

- ▦ **用戶-物品矩陣**：起點都是一個巨大的**用戶-物品互動矩陣**，是典型的 **[稀疏矩陣](09-04-sparse_modeling.zh-hant)**：    
    - 矩陣 $R \in \mathbb{R}^{m \times n}$，其中 $m$ 為用戶總數，$n$ 為物品總數，一行代表一用戶，一列代表一物品。
    - 元素 $R_{ui}$ 表示用戶 $u$ 對項目 $i$ 的評分或互動值（如點擊次數、購買次數、偏好分數等）。
- 📐 **相似度計算**：無論是**皮爾遜相關係數**還是**餘弦相似度**，皆大量使用**向量運算**。 
    - **餘弦相似度**：其中 $R_u, R_v$ 分別為用戶 $u,v$ 的行向量。  
      $$
      \text{sim}(u,v) = \frac{R_u \cdot R_v}{\|R_u\|\|R_v\|}
      $$
    - **皮爾遜相關係數**：其中 $\bar{R}_u$ 為用戶 $u$ 的平均評分。  
      $$
      \text{sim}(u,v) = \frac{\sum_i (R_{ui}-\bar{R}_u)(R_{vi}-\bar{R}_v)}{\sqrt{\sum_i (R_{ui}-\bar{R}_u)^2}\sqrt{\sum_i (R_{vi}-\bar{R}_v)^2}}
      $$
    - **物品–物品相似度**：計算方式與用戶–用戶相似度公式相同，只需將「用戶行向量」改為「物品列向量」即可。
- ⛓‍💥 **矩陣分解**（Matrix Factorization）：  $$ R \approx P \times Q^T $$
	- $P \in \mathbb{R}^{m \times k}$：**用戶–潛在因子矩陣**  
	- $Q \in \mathbb{R}^{n \times k}$：**物品–潛在因子矩陣**  
	- $k \ll \min(m,n)$ 為潛在因子維度  
- 👍 **預測評分**：  $$ \hat{R}_{ui} = P_u \cdot Q_i^T  $$
	-  這表示用戶 $u$ 的潛在偏好向量 $P_u$ 與項目 $i$ 的潛在特徵向量 $Q_i$ 的內積，作為對 $R_{ui}$ 的預測。
:::

### 🤝演算法過程🔄 

不論是基於用戶或項目，協同過濾的流程通常包含以下步驟：

1. 📥 **資料蒐集**：建立龐大的**用戶-項目互動矩陣**，記錄用戶與項目的互動數據，如評分、點擊、購買記錄等。
2. 📐 **相似度計算**：根據用戶或項目的數據，計算其間的相似度。    
3. 🧑‍🤝‍🧑 **鄰居選擇**：挑選最相似的用戶或項目作為參考。  
4. 👍 **產生推薦**：根據鄰居偏好，預測並推薦最可能感興趣的項目。

## 🌟 定位與應用考量
    
理解`協同過濾`在 AI 領域中的定位，有助於應用時考量其適用情境與優化方向。

### ⚓🗺 定位

在決策方面，協同過濾提供一套數據驅動的**信息過濾框架**，幫助使用者、設計者或智能體快速做出選擇：
* 🖼️⏱️ [框架問題](01-04-Frame_Problem.zh-hant)：從海量資訊中過濾出對特定用戶有價值的內容，具備**即時篩選**與**創造適應**（依據大數據與個別用戶數據）的特性。
* 🔴🧐🧭 [指導型分析](06-03-analysis_prescriptive.zh-hant)：能直接向用戶推薦具體項目，符合「直接給出行動建議」的特性。

若以[☸ AI 導向](05----ai_orientations.zh-hant)定位，協同過濾的應用明顯落在：
- ☸🌀[數據導向](05-02-oriented_data.zh-hant)：分析**用戶行為數據**以建構**隱性知識**，即「什麼樣的人喜歡什麼樣的東西」，並利用此知識進行推薦。
- ☸🤖 [智能體／代理人導向](05-03-oriented_agent.zh-hant)：協同過濾可視為推薦代理人，代表用戶從海量資訊中篩選最佳選擇。

### 📐🌉 應用考量

協同過濾是個強大的工具，但也存在其局限性，常需透過結合其他技術來彌補：

- 🥶 **冷啟動問題**（Cold Start Problem）：新用戶或新項目加入時，因缺乏互動數據，難以提供準確推薦。    
- 🧊 **稀疏性問題**：用戶行為數據稀疏，導致相似度計算不準確。    
- 🙈 **可解釋性問題**：使用複雜矩陣分解技術時，推薦理由難以直觀解釋。

此外，在 AI 系統中，協同過濾可與以下方法結合：

* 🏮💪 [行為主義](02-06-behaviorism.zh-hant)的**強化學習**：
	* 🔄 **互動式推薦**：根據使用者即時反饋動態調整推薦策略。
	* ⚖️ **探索與利用平衡**：引入新項目探索，避免過度集中於既有偏好。
* 🏮🧬 [連結主義](02-05-connectionism.zh-hant)的**深度學習**：
	* 🧠 **神經協同過濾**（Neural Collaborative Filtering，NCF）：使用深度神經網路學習複雜、非線性的用戶—項目互動模式，以捕捉傳統線性模型難以發現的細微偏好，例如 YouTube 推薦系統。
	* 🧪 **混合式推薦**：結合內容特徵（如電影類型、演員、商品描述）與協同訊號，克服冷啟動問題。Amazon 和 Spotify 等平台採用此方法，融合群體智慧與內容資訊以提供更準確推薦。
* 🌉🎁 [AI工程](10----ai_engineering.zh-hant) 及 [產品經理](#sec-ai-pm) 實踐的一部分：
	* 🔌 整合[API界面](@sec-api-mcp)、**評估指標**（如精確度、召回率）以及**可解釋性**（可輔以 LIME 或 SHAP 技術），以突顯產品價值並對齊需求與價值觀。

協同過濾在 AI 應用中常與其他技術協作，以提升性能與使用者體驗。例如，協同過濾可結合**圖神經網路**（Graph Neural Networks, GNN），利用使用者—項目圖結構進行高階關係建模。

***

<!--
## 🔄歷史演進🗿
-->

::: {.callout-tip #tip-math-collaborative-filtering title="應用小帖~🚿協同過濾🤝" collapse=false open=true }

- ⚓ **定位** 與 🌉 **應用考量**  
    - 🖼️⏱️ [框架問題](01-04-Frame_Problem.zh-hant)：即時篩選、創造適應  
    - 🔴🧐🧭 [指導型分析](06-03-analysis_prescriptive.zh-hant)：直接給出行動建議  
    - ☸🌀 [數據導向](05-02-oriented_data.zh-hant)：從行為數據建構隱性知識  
    - ☸🤖 [智能體／代理人導向](05-03-oriented_agent.zh-hant)：作為推薦代理人  
    - 🚧 **應用局限**：🥶 冷啟動、🧊 稀疏性、🙈 可解釋性  
    - 🌉 **應用補強**：  
        * 🏮💪 [強化學習](02-06-behaviorism.zh-hant)：互動式推薦、探索與利用平衡  
        * 🏮🧬 [深度學習](02-05-connectionism.zh-hant)：神經協同過濾、混合式推薦  
        * 🌉🎁 [AI工程](10----ai_engineering.zh-hant) 與 [產品經理](#sec-ai-pm)：API整合、評估指標、可解釋性
- 🏁 **小結**  
    - 協同過濾是一種**數據驅動心智框架**，結合 [關聯性](04-01-probabilistic_association.zh-hant) 與 **相似度**  
    - 在 [AI 產品](#sec-ai-pm) 與 [AI 工程](10----ai_engineering.zh-hant) 中，支援**推薦、配對、分類**  
    - 可與**強化學習**、**深度學習**結合，提升個性化與商業價值
:::

## 🏁 小結及相關條目

`協同過濾`是一種基於**使用者行為**數據庫與**線性代數**數學基礎的**數據驅動**心智框架，專注於發現 **[關聯性](04-01-probabilistic_association.zh-hant)** 與 **相似度** 以達成「人以群分，物以類聚」效能。在[AI 產品](#sec-ai-pm)與[AI 工程](10----ai_engineering.zh-hant)領域，此框架能基於大量**互動數據**（如評分、點擊、購買記錄等），實現**推薦**、**配對**、**分類**等任務。

它能有效應對現代 [框架問題](01-04-Frame_Problem.zh-hant)，具備**即時篩選**與**創造適應**特性，協助設計能應對**資訊過載**的[數據導向](05-02-oriented_data.zh-hant)系統，並展示其 [指導型分析](06-03-analysis_prescriptive.zh-hant) 價值，在 **[任務導向](05-01-oriented_task.zh-hant)** 、 **[智能體／代理人導向](05-03-oriented_agent.zh-hant)** 應用中實現更佳的**篩選**、**協調**與**最佳化**。

此外，協同過濾亦可結合**強化學習**（如，即時反饋調整推薦）與**深度學習**（如，神經協同過濾捕捉細緻偏好）等技術，設計出更具**個性化**與**人性化**的推薦或匹配系統，提升使用者體驗與商業價值。