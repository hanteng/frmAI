---
tags:
  - 智能程式助理
  - 脈絡感知
  - 大語言模型
  - AI工程
  - 提示工程
  - 知識融合
  - AI對齊
  - 多模態AI
  - 對話系統
  - 生成式AI
  - 框架問題
  - 智能體
  - 系統創新
  - 專家混合模型
---
# 🪟脈絡工程🧭 {#sec-context-engineering}
`脈絡工程`（Context Engineering）是一套讓 AI 具備**脈絡感知**（Context-Awareness）能力的技術與方法論，確保系統能理解使用者的**意圖**、**情境**與**任務背景**，並生成更相關、精確且實用的輸出。它的目標是打造能「讀懂空氣」的 AI，使回應與行動更貼近真實需求與情境。

與 [提示工程](10-03-prompt_engineering.zh-hant) 或 [檢索增強生成（RAG）](10-04-retrieval_augmented_generation.zh-hant) 相比，`脈絡工程`涵蓋範圍更廣，著重於**系統性地設計、組織與管理** AI 在推理與生成時所使用的**全部脈絡**——包括任務描述、背景知識、互動歷史、外部訊號等。資料來源不限於外部知識庫，還可來自使用者輸入、感測器、[API 與 MCP工具](@sec-api-mcp)、多模態感知輸入等。可以說，它是在提示工程與 RAG 基礎上的進一步**系統創新工程**，確保**有效且安全**地共享**脈絡資訊**。

在應用層面，`脈絡工程`推動了從「單輪指令」到「多輪對話」的演進，並促進了從「單模態任務」到「跨模態任務協作」的轉變，支撐更複雜的 Agentic AI 與「知識融合」應用。實際應用時可能涉及到不同層次的脈絡：産品、專案、大語言模型、外部知識等等。它同時與 **[框架問題](01-04-Frame_Problem.zh-hant)**、**[對齊與控制問題](01-06-Alignment_Control_Problem.zh-hant.md)** 等核心議題緊密相關，並衍生出更多 AI 控制與安全挑戰，包括潛在的 [語言賽局](01-07-Language_Games.zh-hant) 風險及創新。

***

## 🏷️核心概念

`脈絡工程`的設計範疇涵蓋 **脈絡收集**、**脈絡組織** 與 **脈絡優化** 三大面向，並可結合多代理（Agents）與多模態資料，形成可持續更新、可重用的上下文系統，支撐更精準的推理與生成。

- 📥 **脈絡收集**
  - 🗂️ **脈絡來源**：包括使用者輸入、歷史對話、檢索結果（RAG）、外部 API 資料，以及多模態感知輸入（如圖像、音訊、影片），並可輔以時間與地點資訊、裝置狀態等情境訊號，確保模型獲取的資訊完整且具時效性。
  - 🔌 **API 與模組協定整合**：透過 [API 與 MCP](@sec-api-mcp) 等標準化協定安全共享脈絡，避免資訊孤島，並支援跨系統、跨代理的資料流通。
- 🏗️ **脈絡組織**
  - 🏗️ **脈絡結構化**：將收集到的脈絡分為任務描述、背景知識、限制條件、範例與輔助資訊等模組，方便模型解析與利用，並提升重用性。
  - 🌐 **跨模態脈絡融合**：將文字、圖像、音訊等不同模態的資訊轉換為統一表示，讓模型能在多模態環境中進行一致且高效的推理。
  - 🧩 **脈絡與提示協同**：將脈絡工程與提示工程結合，確保提示能正確引導模型利用脈絡，並在多輪互動中保持語境一致。
- 🔄 **脈絡優化**
  - ⏳ **脈絡長度管理**：在 Token 限制下，透過摘要、壓縮與關鍵資訊提取，保留最有價值的內容，避免冗餘資訊干擾模型判斷。
  - 🔄 **動態脈絡更新**：根據任務進展與模型回應，及時調整脈絡內容與優先順序，確保系統始終聚焦於最相關的資訊。
  - 🛡️ **脈絡安全與對齊**：過濾敏感或不可靠的脈絡來源，並檢查生成內容是否符合安全與倫理規範，防範脈絡污染與提示注入等風險。

**小結**：`脈絡工程`是將「任務需求、背景知識、互動歷史與外部檢索結果」組織成智慧化上下文的系統創新過程，並優化其與基礎模型的輸入輸出互動，以確保 AI 能真正具備脈絡感知，準確理解使用者的意圖與情境目標，並在多代理、多模態的應用場景中保持高效與安全。

## 🛅 闡明範例{#exm-ai-coding-assistant}

### 🧑‍💻🫶智能程式助理

`智能程式助理`或`代理式 AI 程式設計助理`（AI Coding Assistants）的目標不僅是生成程式碼，更要理解開發者的複雜需求與專案脈絡（可能橫跨多份文件），並主動協助完成各類程式設計任務。

這類助理的共通功能源自底層 LLM 的能力及其在程式設計領域的應用，至少有兩種脈絡可用來加值：  
一是**專案程式碼風格或需求文件**的脈絡，二是與助理**多輪對話**的脈絡。

1. **🐸⚡ 程式碼生成與自動完成**    
    - **⚙功能**：根據自然語言提示或現有程式碼脈絡，生成程式碼片段、完整函式或類別，並提供智慧化自動完成。        
    - **🫶脈絡增值**：        
        - 📳 **專案**：生成符合專案規範、使用現有函式庫並與模組風格一致的程式碼。 
        - 🗫 **對話**：納入過往對話中開發者的意圖與需求約束。            
2. **🐘💞 程式碼解釋與文件**    
    - **⚙功能**：以清晰自然的語言解釋複雜程式碼、演算法或語法，並自動生成函式與類別文件（docstrings）。        
    - **🫶脈絡增值**：        
        - 📳 **專案**：解釋時聚焦專案相關模式與最佳實踐，並生成符合文件標準的內容。    
        - 🗫 **對話**：依開發者的理解程度與提問歷程調整解釋深度。            
3. **💡⚕ 偵錯與錯誤解決**    
    - **⚙功能**：識別潛在錯誤、提供修復方案並解釋錯誤訊息，能分析堆疊追蹤精確定位問題。        
    - **🫶脈絡增值**：        
        - 📳 **專案**：修復建議會考慮專案架構與常用除錯策略。            
        - 🗫 **對話**：整合開發者描述的情境與已嘗試方法，提供更精準的建議。            
4. **✨🚀 程式碼重構與優化**    
    - **⚙功能**：建議改善結構、風格與效能，支援跨語言轉換與現代化更新。        
    - **🫶脈絡增值**：        
        - 📳 **專案**：重構建議遵循專案風格指南並符合性能目標。            
        - 🗫 **對話**：優先考量開發者在對話中表達的重構目標。            
5. **✍️▶️ 自然語言轉程式碼**    
    - **⚙功能**：將自然語言需求直接轉譯為程式碼，是代理性行為的核心。  
    - **🫶脈絡增值**：        
        - 📳 **專案**：生成程式碼遵循命名慣例與架構模式，並假設開發者熟悉特定 API。            
        - 🗫 **對話**：依逐步細化的需求生成更貼近意圖的程式碼。            
6. **🌐🧠 專案脈絡理解與管理（專案管理）**    
    - **⚙功能**：理解專案全貌，包括檔案結構、現有程式碼、依賴關係與近期互動目標。        
    - **🫶脈絡增值**：        
        - 📳 **專案**：遵循文件規範與架構設計，並引用內部程式碼進行分析或生成。 
        - 🗫 **對話**：追蹤對專案目標、問題與偏好的持續討論，提供更個人化的協助。

這些功能與脈絡增值共同展現了`智能程式助理`如何作為智慧夥伴，深刻改變開發者體驗。其他可延伸的方向還包括**版本控制**與**開發環境**整合。

### 命令列🆚IDE

`智能程式助理`依使用介面可分為**命令列介面**（如 Gemini CLI、Claude）與**整合開發環境**（IDE）（如 Cursor）：

* 🗔 **命令列介面**
    * **⚙功能**：支援快速查詢、程式碼生成、錯誤分析與版本控制指令。
    * **🫶脈絡增值**：整合 Git 狀態、分支策略與 commit 訊息風格，並根據 CLI 操作歷程提供上下文感知的建議與命令補全，包括版本控制指令生成。
* 🖥 **整合開發環境**
    * **⚙功能**：提供即時程式碼建議、錯誤提示、重構工具與文件生成。
    * **🫶脈絡增值**：可視化版本控制、模組依賴圖與測試覆蓋率，並透過互動式提示與側欄對話持續追蹤開發者意圖，提供精準協助。

從程式碼生成到錯誤修復，從自然語言理解到專案管理，智能程式助理的真正價值在於其**脈絡感知能力**。這種能力不僅來自模型的語言理解，更源於`脈絡工程`的系統化設計——將專案脈絡與對話脈絡整合進 AI 的生產力流程中。

橋接「懂你」與「懂程式」，未來的程式設計將不再是孤立的編碼，而是與 AI 智慧夥伴共同完成的協作旅程。

## 🆚專家混合模型 (MoE)

**專家混合模型** (MoE)是一種神經網路架構，它由多個專門不同類型任務或數據的「專家」子網路組成，並透過一個「門控網路」來決定將輸入分流導向哪些專家，以實現更高效精準回應。雖然它本身不是`脈絡工程`的技術，但兩者有著極為緊密的共生關係。

換句話說，設計與執行`脈絡工程`時，可以考慮使用 MoE 支持以下方向的應用：
* **專門化處理**：MoE 核心是讓模型由多個「專家子網路」組成，每個專家擅長處理特定類型的資訊或任務。這讓 AI 能在面對複雜、多樣的上下文時，將不同部分分配給最適合的專家進行處理，例如，將程式碼分給一個專家，將法律文件分給另一個專家。這大幅提升了處理效率與準確性。
* **擴大上下文視窗**：傳統模型在處理極長的文本（例如數百頁的法律文件或書籍）時，會遇到記憶和運算上的瓶頸。MoE 架構通過「[稀疏性](09-04-sparse_modeling.zh-hant)」解決了這個問題，只啟用最相關的專家來處理當前輸入，從而能在不顯著增加運算成本的情況下，有效擴大模型的上下文處理能力。
* **高效能與低延遲**：對於需要即時處理大量上下文的應用，如即時對話或大型文件分析，MoE 能夠大幅降低延遲。因為每次推論（inference）時，只有一小部分參數被啟動，這使得模型能夠以更快的速度回應，同時維持龐大的總參數規模。

總結來說，MoE 提供高效的「知識專業分工」，而`脈絡工程`負責**提供**和**管理**豐富的上下文，來利用 MoE 為底使 AI 模型更有效率、更聰明地**利用**這些脈絡。兩者相輔相成，共同推動 AI 系統處理複雜任務的能力。

## 👍💖最佳實務  

為了讓`脈絡工程`發揮效能，不再只是如**提示工程**的「用詞和措辭」調整，而是提供「最相關的完整的事實、規則和文檔」（參考[情境「相關性」現代觀點](@sec-relevance-modern)）。以下是常見的最佳實務： 

- **專案**及**産品**層次優化🎁🌱 ：
	- 🖼️⏱️ **明確脈絡目標**：釐清用途與需求，避免加入無關資訊，如「[三文件原則](https://github.com/mattgierhart/PRD-driven-context-engineering)」：
		- 指揮中心（Command Center）管專案的**運作事實**；
		- 產品需求文件（PRD）管**產品事實**：單一、漸進式隨產品演進的文件；
		- 當前史詩級任務（EPIC）管專案的**執行事實**：單一「史詩級任務」及其子任務、技術細節和執行計畫。
- **大語言模型**與**提示工程**層次優化😵‍💫🧞‍♀️
	- 🗃️ **模組化脈絡設計**：將脈絡分為可重用的模組，方便不同任務間快速組裝。  
	- 🧪 **測試脈絡配置**：透過 A/B 測試比較不同脈絡組合對輸出的影響。  
	- 🔄 **迭代優化**：根據**模型表現**與**使用者反饋**，調整**脈絡**內容與結構。  
- **知識驅動生成**層次優化🔗📝
	- 🛡️ **驗證脈絡來源**：確保外部資料的真實性與可靠性，防止檢索污染。  脈絡品質與更新策略對 [智慧體可靠性與評估](10-02-agent_reliability_evaluation.zh-hant) 有直接影響。
	- ⏱️ **平衡脈絡豐富度與效率**：在提供足夠資訊的同時，避免超過模型脈絡長度限制。  
	- 🤝 **升級 RAG 與 Agents 結合**：在多步推理與任務規劃中，動態調用檢索與工具，更新脈絡內容。  

**小結**：最佳實務的核心是讓脈絡既「足夠」又「精準」，並能隨任務動態調整。在產品層面，脈絡策略的規劃與落實是 [AI 產品經理](#sec-ai-pm) 的重要職責之一。

## 🪬💞創新思路  

`脈絡工程`還有以下[創新思路](https://github.com/Meirtz/Awesome-Context-Engineering/) ：

* 🦾🔄💪 **多代理人系統**（Multi-Agent）：著重多個AI代理人有效協同，包括：
	* **溝通協議（Communication Protocols）**：定義代理人之間交換資訊的標準。
	* **協調機制（Coordination Strategies）**：設計代理人之間分工合作和解決衝突的策略。
* 🏛️☸⚖️複雜脈絡組織與圖形問題解決（Complex Context Organization and Solving Graph Problems）：
	* 讓AI能夠理解和處理非線性的、圖形化的資訊，例如關係數據庫、知識圖譜或社群網絡。
	* 使AI能夠應對更複雜、更需要推理的任務，例如理解複雜的組織架構或人際關係網絡。
* 🧠🤖🚨 **AI 記憶與長期上下文管理**：這項創新專注於讓 AI 具備長期記憶與學習能力。透過**遞歸式摘要**和**上下文修剪**等技術，AI 不僅能從過去的互動中學習，還能高效地整理並壓縮資訊，克服上下文窗口限制，確保在複雜情境下仍能維持準確性。
* 🛠️🔗🔐 **複雜工具整合與情境化協作**：讓 AI 代理人不僅能使用外部工具，更能智慧地選擇、協調多種工具，如多模態上下文整合（Multimodal Context Integration），並與環境進行複雜互動。這將 AI 的角色從被動指令執行者，轉變為能主動利用工具解決複雜問題的「AI 協作者」。
* 🌉🔗📝 **先進檢索與知識圖譜應用**：這條路徑旨在超越傳統的檢索增強生成（RAG），透過更精密的技術讓 AI 能夠有效利用外部知識庫。例如，結合**知識圖譜**來提供更結構化的關聯資訊，或透過**模組化RAG**來提升檢索的精準度，讓 AI 在複雜查詢中能找到更準確的答案。
* 📡🌡️🤖 **動態情境解決與跨領域推理**：這項創新著重於讓 AI 能夠處理複雜且非線性的問題。它不僅是簡單地理解文字，而是能夠像人類一樣，對圖形化的關係數據、系統架構等進行推理，這將使 AI 能夠應對需要跨領域知識和高階認知能力的挑戰性任務。

在實現**競爭與合作**的轉型方面，透過 **「語言賽局](01-07-Language_Games.zh-hant)」** 的策略性互動，還可能建構出**多代理人語言賽局**（Multi-agent Language Games）。這些新興系統設計顯示，`脈絡工程`不僅是一項技術，更是引領未來 AI **系統創新**的跨界關鍵領域：  

* 👨‍🚀**AI 協作者與團隊競合轉型**：`脈絡工程`是推動 AI 從單純的「工具」進化為主動的「協作者」的關鍵技術。它賦予 AI 理解情境、預測需求與主動協助的能力，使其不再只是被動的問答機器，而能在複雜任務中發揮協作價值，甚至不只一個角色，而是具備多種不同專業知識形成**競爭及合作**的賽局。

***

## 🤞❣️注意事項  

`脈絡工程`在設計與部署時需注意以下挑戰與風險：  

- 🔒 **隱私與安全**：避免將敏感資訊直接放入脈絡中，必要時進行脫敏處理。  
- 🚫 **脈絡污染**：防範惡意或錯誤資訊進入脈絡，影響生成結果。  
- 📉 **脈絡過載**：過多或冗餘資訊可能干擾模型判斷，降低輸出品質。  
- 🛡️ **防禦提示注入**：在多輪對話中防範惡意輸入修改脈絡內容。  
- 🔍 **結果驗證**：對生成內容進行事後檢查，確保其與脈絡一致且正確。  

透過精煉的情境框架，它幫助 AI 在動態環境中辨識並專注於相關資訊，從而提升推理與決策效率，應對 **[框架問題](01-04-Frame_Problem.zh-hant)**；藉由納入外部系統知識與工具，讓系統連結至世界的行動方案及後果檢驗，有助於緩解 **[符碼紮根問題](01-03-Symbol_Grounding_Problem.zh-hant)**。同時，它也為應對 **[對齊與控制問題](01-06-Alignment_Control_Problem.zh-hant.md)** 提供了具脈絡實踐及檢驗的路徑。  

***

## 🌉回顧及資源🪸

- ✨ **核心知識**：`脈絡工程`是連接 [提示工程](10-03-prompt_engineering.zh-hant) 與 [檢索增強生成（RAG）](10-04-retrieval_augmented_generation.zh-hant) 的關鍵橋樑，負責將多來源、多模態資訊（任務描述、背景知識、互動歷史、外部檢索結果、感測器資料、API 輸出等）整合成高效可用的上下文，並以結構化方式輸入 LLM。這一過程直接影響系統的推理深度、生成品質、可解釋性與對齊性，也促進更複雜的「多輪對話」、「跨模態任務協作」可能性，引發更多 AI 控制、AI 安全等問題。
- ✅ **實務應用檢核表**：
## 🌉回顧及資源🪸

- ✨ **核心知識**：`脈絡工程`是連接 [提示工程](10-03-prompt_engineering.zh-hant) 與 [檢索增強生成（RAG）](10-04-retrieval_augmented_generation.zh-hant) 的關鍵橋樑，負責將多來源、多模態資訊（任務描述、背景知識、互動歷史、外部檢索結果、感測器資料、API 輸出等）整合成高效可用的上下文，並以結構化方式輸入 LLM。這一過程直接影響系統的推理深度、生成品質、可解釋性與對齊性，也促進更複雜的「多輪對話」、「跨模態任務協作」可能性，引發更多 AI 控制、AI 安全等問題。

- ✅ **實務應用檢核表**  
  > 下表將檢核項目依「三大面向」（脈絡收集、脈絡組織、脈絡優化）與「三大層次」（專案／產品、大語言模型／提示工程、知識驅動生成）交叉整理，方便在不同場景下快速檢查與落實脈絡工程的最佳實務。

  - 📥 **脈絡收集**  
    - **專案／產品層次**  
      - 明確定義脈絡收集目標與範圍，避免引入無關資訊  
      - 確保資料來源涵蓋專案需求文件、版本控制紀錄、使用者回饋等  
    - **大語言模型／提示工程層次**  
      - 設計提示以引導模型主動詢問缺失的脈絡  
      - 在多輪對話中保留並更新關鍵上下文  
    - **知識驅動生成層次**  
      - 驗證外部檢索結果的真實性與可信度  
      - 避免將低品質或不可靠的資料納入脈絡  

  - 🏗️ **脈絡組織**  
    - **專案／產品層次**  
      - 將脈絡分模組化（任務描述、背景知識、限制條件、範例等）以便重用  
      - 建立跨團隊一致的脈絡結構標準  
    - **大語言模型／提示工程層次**  
      - 在提示中明確標示不同模組的用途與優先順序  
      - 測試不同脈絡組合對輸出品質的影響  
    - **知識驅動生成層次**  
      - 將檢索結果與內部知識融合為統一結構  
      - 在多模態情境下保持資訊表示一致性  

  - 🔄 **脈絡優化**  
    - **專案／產品層次**  
      - 制定脈絡長度管理策略（摘要、壓縮、關鍵資訊提取）  
      - 根據專案進度動態更新脈絡內容  
    - **大語言模型／提示工程層次**  
      - 透過 A/B 測試比較不同脈絡配置的效果  
      - 根據模型表現與使用者反饋迭代優化脈絡  
    - **知識驅動生成層次**  
      - 平衡脈絡豐富度與推理效率，避免超過模型上下文限制  
      - 部署安全與對齊策略，防範脈絡污染與提示注入  

- 🏄 **延伸閱讀與工具資源**：可參考最新的 OpenAI、Anthropic 等關於脈絡管理的**最佳實務**文件，RAG 框架（如 LangChain、Haystack）的**脈絡組裝模組**，以及多代理系統的**脈絡協作**案例。

## ✎ 編輯筆記

- [ ] 逐句事實查核 
- [ ] 邏輯流程
- [ ] 本部分內部鏈結
- [ ] 本書各章內部鏈結
- [ ] 外部資源鏈結


