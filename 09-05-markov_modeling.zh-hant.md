---
tags:
- 機率模型
- 序列建模
- 隱馬可夫模型
- 機器學習
- 大語言模型
- 強化學習
- 預測分析
- 自然語言處理
- 馬可夫決策過程
---
# ⛓️🔄 馬可夫模型 {#sec-markov-modeling}

`馬可夫模型`（Markov Modeling）是種「**機率式的**」 （probabilistic）「**無記憶性**」（memoryless）的**序列建模** （Sequence Modeling），以便高效處理序列數據。馬可夫模型適用於諸多領域的建模，如**核能**、**通訊編碼**、**自然語言**、**情感分析**、以及許多領域中的**時間序列預測**（Time Series Forecasting）。為了應對有效理解和預測一系列數據點之間的依賴關係，馬可夫模型捕捉此序列性的是**馬可夫假設** (Markov Assumption)，假定在一個序列中，當前的狀態僅僅取決於前一個（或前幾個）狀態，而與更早的狀態無關。這無記憶性假設使得馬可夫模型在數學建模與計算上具有高度簡潔性與可解析性。

`馬可夫模型`或`馬可夫鏈`的理論雖由俄國數學家安德烈·馬可夫（Andrey Markov）於 20 世紀初提出，但在二戰期間的**曼哈頓計畫**中，相關的**隨機過程**與**狀態轉移**分析被廣泛應用於**核反應模擬**與**通訊解碼**等任務。與 [蒙地卡羅方法](09-06-monte_carlo_tree_search.zh-hant) 的命名淵源類似，當時的科學家們（如馮諾伊曼、費曼等）將馬可夫鏈作為分析**隨機系統**行為的核心工具，體現了以數學機率模型支撐複雜工程決策的精神。

`馬可夫模型`透過整合**隨機過程**、**狀態轉移**、等**序列建模**的數學原理，是一種多用途的機率工具，在**語言**、**學習**、**推理**甚至**可靠性工程**和**資訊理論**等領域都有重要的應用。人工智慧**強化學習**中，**馬可夫決策過程**（Markov Decision Process, MDP）的框架，適用於結果部分隨機、部分受決策者控制的情況下對決策進行建模，允許強化學習演算法能夠習得最優策略。總之，`馬可夫模型`能在可解釋性與低計算成本的場景中發揮作用：

> 透過設計**狀態空間**、估計**轉移機率**、推斷**隱狀態**等方法，根據**應用場景**與**資料特性**，構建可解釋且高效的序列預測與決策模型。

## 🚀 應用場景

馬可夫模型在 AI 與數據科學中有廣泛應用：

- 🗣️ **語言建模**：早期的 n-gram 語言模型即基於馬可夫假設，透過統計詞與詞之間的轉移機率進行下一詞預測。
- 🎯 **強化學習**：馬可夫決策過程（Markov Decision Process, MDP）是強化學習的數學基礎，用於描述環境狀態、行動與獎勵之間的關係。
- 🧩 **隱馬可夫模型**（Hidden Markov Model, HMM）：廣泛應用於語音識別、基因序列分析、手勢識別等需要推斷隱藏狀態的任務。
- 📈 **時間序列分析**：用於建模金融市場狀態轉換、用戶行為模式、設備健康狀態等。
- 🕹️ **遊戲 AI 與策略規劃**：在棋類、模擬遊戲中，馬可夫模型可用於建構狀態轉移圖，輔助策略搜尋與評估。

馬可夫模型的應用場景橫跨從低維可解釋模型到複雜的決策系統，展現了其在不同領域的適應性與理論價值。

***

## 🔬 細說

馬可夫模型
### ♾️📊 數學支撐

數學上，馬可夫性質可表述為：

$$
P（X_{t+1} \mid X_t, X_{t-1}, \dots, X_0） = P（X_{t+1} \mid X_t）
$$

其中 $X_t$ 表示系統在時間 $t$ 的狀態。這種性質使得馬可夫模型能夠用**狀態轉移矩陣**（State Transition Matrix）或**轉移機率分佈**來完全描述系統的動態行為：

- 🎲 **馬可夫性質**：未來狀態僅依賴當前狀態，形式化為 $P（X_{t+1} \mid X_t）$。
- 🗺️ **狀態轉移矩陣**：對於有限狀態集合 $\{s_1, s_2, \dots, s_n\}$，轉移矩陣 $P$ 的元素 $P_{ij}$ 表示從狀態 $s_i$ 轉移到 $s_j$ 的機率。
- 🕵️ **隱馬可夫模型（HMM）**：在馬可夫鏈基礎上引入觀測層，透過前向-後向演算法（Forward-Backward Algorithm）與維特比演算法（Viterbi Algorithm）進行隱狀態推斷。
- 📐 **平穩分佈**：對於不可約且非週期的馬可夫鏈，存在唯一的平穩分佈 $\pi$ 滿足 $\pi P = \pi$，描述長期狀態分佈。

這些數學基礎為馬可夫模型提供了嚴謹的理論支撐，使其在序列建模與決策分析中具備可解析性與可驗證性。

### ⚙️ 演算法示例

1. **狀態轉移矩陣估計**  
   $$
   \hat{P}_{ij} = \frac{\text{count}(s_i \to s_j)}{\sum_k \text{count}(s_i \to s_k)}
   $$

2. **前向演算法（Forward Algorithm, HMM）**  
   $$
   \alpha_t(j) = \left[ \sum_i \alpha_{t-1}(i) a_{ij} \right] b_j(o_t)
   $$

3. **維特比演算法（Viterbi Algorithm）**  
   $$
   \delta_t(j) = \max_i \left[ \delta_{t-1}(i) a_{ij} \right] b_j(o_t)
   $$

這些演算法示例展示了馬可夫模型如何在已知或未知狀態下進行機率推斷與最優路徑搜尋。

***

### 🐍🔧 常見Python工具

在 Python 生態中，馬可夫模型可透過以下工具實作與應用：

* 🐍🔢 **NumPy** ：用來計算狀態轉移矩陣、矩陣冪、n 步後狀態分佈、平穩分佈等
* 🐍🔬 **SciPy**：用來處理高階線性代數、統計分佈、平穩分佈求解、鏈的性質分析等
* 🐍🤖 **Scikit-learn**：用來機器學習建模，將馬可夫輸出作為特徵進行分類/回歸
* 🐍🚀TensorFlow / PyTorch：建構深度序列模型，包括高維狀態空間建模、混合式策略學習
* 🐍🔍 **hmmlearn**：提供隱馬可夫模型（HMM）的訓練與推斷，包括高斯 HMM、離散 HMM 等。應用場景包括語音識別、基因序列分析等
* 🐍📈 **pomegranate**：支援貝葉斯網路、馬可夫鏈、HMM 等機率圖模型，並具備高效的 Cython 實作。
* 🐍📚 **markovify**：簡單易用的馬可夫鏈文本生成庫，常用於原型開發與文本隨機生成。

## 🌟 定位與應用考量

理解 `馬可夫模型` 在 AI 領域中的定位，有助於應用時考量適用情境與優化方向。

### ⚓🗺 定位

根據其數學原理與建模流程，馬可夫模型的定位與運用如下述：

*  🔁😽🪄  [決策演算法](06-06-decision_making_algorithm.zh-hant)：支持決策演算法，馬可夫模型作為通用的**機率式序列建模**方法，透過**狀態轉移機率**來描述系統的動態行為**模擬**行動序列。
* 🔴🧐🧭 [指導型分析](06-03-analysis_prescriptive.zh-hant)：馬可夫模型可用於「在多種可能狀態轉換中，預測最可能的未來狀態或行動」，不僅分析現況，還能直接提供決策依據。

若以[☸ AI 導向](05----ai_orientations.zh-hant)定位，馬可夫模型的應用明顯落在：

* ☸🤖 [智能體／代理人導向](05-03-oriented_agent.zh-hant)：馬可夫決策過程（MDP）為智能體在不確定環境中制定策略提供數學基礎，使其能根據當前狀態與轉移機率自主選擇行動。
* ☸🛠 [任務導向型](05-04-oriented_task.zh-hant)：馬可夫模型可用於解決特定任務，例如語音識別中的隱狀態推斷、用戶行為預測、或機器人路徑規劃中的狀態轉換建模。

然而，由於涉及**機率假設與狀態定義**，在應用時需思量☸⚖️ [倫理／互動導向型](05-05-oriented_ethics.zh-hant) 及 ☸🏛️ [知識導向](05-01-oriented_knowledge.zh-hant)，以確保模型假設合理、數據來源合規，並避免因狀態定義偏差導致的決策風險。已有研究將「道德價值權重」（moral worth）引入傳統的馬可夫決策過程（MDP），亦有研究在經濟學的馬可夫模型中引入「道德異質性」（moral heterogeneity）。因此，不管是實踐應用或情境模擬，馬可夫決策過程或馬可夫模型都能按倫理及專業知識引入，以可解釋的方式應對不確定性問題。

### 📐🌉 應用考量

由於馬可夫模型是一種基於**馬可夫性質**的通用序列建模方法，可與**強化學習**及**深度學習**結合進行優化，應用思路包括：

* 🏮💪 [行為主義](02-06-behaviorism.zh-hant)的**強化學習**：
	* **策略由經驗累積**：在 MDP 框架下，策略品質取決於大量狀態—行動—獎勵的統計，與行為主義強調的「由外部刺激與回饋塑造行為」一致。
	* **互動與回饋**：智能體透過與環境互動收集轉移機率與獎勵分佈，逐步改進策略，體現 trial-and-error 精神。
* 🏮🧬 [連結主義](02-05-connectionism.zh-hant)的**深度學習**：
	* **參數化轉移與觀測模型**：可用深度神經網路近似轉移機率或觀測機率，提升在高維狀態空間中的建模能力。
	* **混合式架構**：深度學習負責從大量資料中學得狀態表示與轉移規律，馬可夫模型則提供可解釋的序列推斷框架，兩者形成閉環優化。

由於馬可夫模型的數學結構簡潔，**無需大量先驗知識**即可建立基礎模型，但在複雜任務中可透過引入深度特徵表示、部分可觀測馬可夫決策過程（POMDP）等擴展，提升表達能力與適應性。

***

## 🏁 小結及相關條目

作為一種驅動序列推斷與決策的 **[框架思維](01-04-Frame_Problem.zh-hant)**，`馬可夫模型` 能將系統的動態行為抽象為狀態與轉移機率，廣泛應用於[任務與目標規劃](08-06-robot_tasks_and_goals.zh-hant)等領域。其「可解釋性」由狀態轉移矩陣與平穩分佈體現，而「預測能力」則源於對未來狀態分佈的估計及模擬。

在 AI 領域內，馬可夫模型既可作為[指導型分析](06-03-analysis_prescriptive.zh-hant)的基礎工具，也可與[智能體／代理人導向](05-03-oriented_agent.zh-hant) 、[任務導向](05-04-oriented_task.zh-hant) 方法結合，構建高效的決策系統。同時，因其依賴數據驅動的轉移估計與假設，在設計或應用時需思量，需要思量 [倫理／互動導向](05-05-oriented_ethics.zh-hant) 及 [知識導向](05-01-oriented_knowledge.zh-hant)，以確保模型假設合理、數據來源合規，並支援 [AI 對齊與控制問題](01-06-Alignment_Control_Problem.zh-hant.md) 的有效及合理應對。