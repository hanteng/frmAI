---
tags:
- 搜尋演算法
- 規劃演算法
- 機率圖形模型
- 博弈論
- 最佳化
- 決策演算法
- 強化學習
- 啟發式演算法
- 隨機演算法
- AI控制
---
# 🌲蒙地卡羅樹搜尋 {#sec-monte-carlo-tree-search}

`蒙地卡羅樹搜尋`（Monte Carlo Tree Search, MCTS）是種強大的**決策演算法**，結合**搜尋與規劃**（search and planning）的方法，廣泛應用於博弈與自動化系統中。此演算法本質上是一種驅動決策的**框架思維**，能整合賽局中的「**大格局觀**」與「**機會成本**」概念，這也讓它在圍棋、西洋棋等複雜博弈中取得了巨大成功。其基本機制透過**模擬**與**回饋**來選擇最佳**行動序列**。

**蒙地卡羅**（Monte Carlo）這個名稱，源自著名的摩納哥蒙地卡羅賭場。廣義而言，**蒙地卡羅方法**是一類依賴「重複隨機取樣」來獲取數值結果的演算法。此命名由曼哈頓計畫的科學家們（如烏拉姆和馮諾伊曼）所創，旨在體現其演算法的精神：透過大量隨機模擬來解決複雜問題。

MCTS 透過整合隨機模擬、圖論、最佳化等數學原理，實現了其強大的決策能力。其「大格局觀」體現在**啟發式評估函數**（heuristic evaluation/value function），以助 AI 在賽局中最大化勝率；而「機會成本」則由**UCT**（Upper Confidence bounds applied to Trees）公式來體現，它在「已知的好處」（如平均獲勝率）與「未知的可能性」（如節點的未探索程度）之間取得精妙平衡。如此，MCTS 結合**圖論**與**機率模型**，構建其**搜尋與規劃**的狀態與決策空間，精準地框定了賽局的本質。

MCTS 可被視為一種通用的**決策演算法**，其核心思想是：

> 先透過**模擬**探索可能的未來路徑，然後再**規劃**出最優的策略。

## 🚀 應用場景

MCTS 在多種需要高效搜尋與精準決策的情境中表現出色：

- ♟️ **博弈 AI**：是諸如 圍棋（AlphaGo）、頂尖西洋棋及撲克 AI 的核心演算法。（參見[第柒篇 🏆「博弈派」AI](07----game_ai.zh-hant) ）
    
- 🚗 **自動駕駛**：在規劃車輛行駛路徑及進行即時決策時，MCTS 能提供強大的支援。
    
- 🤖 **機器人規劃**：可用於設計複雜的動作序列與任務執行。（參見[任務與目標規劃](08-06-robot_tasks_and_goals.zh-hant) ）
    
- 📦 **資源分配**：在資源有限的條件下，MCTS 能夠優化資源分配策略。
    

這些應用領域的共同特點是決策空間龐大且充滿不確定性。MCTS 能夠在這樣的環境中持續提升決策的品質，展現其強大的適應性與效率。

## 🔬 細說

### ⚙🎲🔭 演算法過程

MCTS 透過以下四個步驟不斷迭代，來模擬不同的決策路徑，並利用啟發式評估函數進行「大格局觀」的評量，最終逐步逼近最佳策略：

1. 🧭**選擇**（Selection）：搜尋從決策樹的根節點（當前決策點）開始，沿著樹狀結構向下選擇最有利的路徑。這個過程需要平衡**探索**（嘗試新的、未知的路徑）與**利用**（選擇已知表現良好的路徑），以最大化尋找優質策略的機會。
    
2. 🌱**展開**（Expansion）：當搜尋到達一個葉節點（尚未完全展開的節點）時，如果該節點還有未被探索過的子節點，MCTS 會隨機選擇其中一個子節點並將其加入決策樹。此步驟**擴展**搜尋的範圍，將新的**決策可能性**納入考量。
    
3. 🎯**模擬**（Simulation）：從新展開的節點開始，MCTS 會進行一連串的模擬，通常是採用隨機或半隨機的方式，模擬遊戲或決策過程直到結束。此步模擬的最終局面結果（例如，贏或輸）將被用來評估該節點的價值。
    
4. 🔄**反向傳播**（Backpropagation）：模擬的結果會沿著決策樹的路徑反向傳播回根節點。每個節點的**統計數據**（如獲勝次數、模擬次數）都會被更新，以便更精確地評估其潛在價值。
    

透過不斷重複以上迭代過程，每個決策路徑節點的估值將更精準，從而做出更優的決策。

### 🕸️🎲 數學支撐

MCTS 的效力來自於其背後的數學原理，主要體現在以下幾個方面：

- 🎲 **隨機模擬**：MCTS 核心的模擬與反向傳播步驟，本質上是在利用**大數法則**（Law of Large Numbers）。透過大量的隨機模擬，每個節點的預期價值（Expected Value）會逐漸收斂到其真實價值，這運用隨機抽樣來解決問題也是其名稱「蒙地卡羅」的由來。
    
- 🕸️ **圖論**：MCTS 使用**決策樹**來表示搜尋空間：樹中的每個節點代表一個狀態（例如，棋盤的局面），節點與節點的連結邉展示不同決策路徑的狀態變化（變動格局），圖論因而**框架**（組織和遍歷）的決策考量空間。
    
- ♾️ **機會成本**賽局**最佳化**：MCTS 常使用**UCT**公式，去找到一個能最大化預期回報的策略，以在「選擇」步驟時能平衡**利用**（exploitation）與 **探索**（exploration）的機會成本賽局。該公式幫助 MCTS 在「已知的好處」（節點的**平均獲勝率**）和「未知的可能性」（節點的**未探索程度**）之間取得平衡。
    

MCTS 是種能透過「**大格局觀**」與「**機會成本**」思維來**驅動決策的框架**，其數學原理及演算法巧妙精準地連結隨機模擬、圖論、最佳化，以助 AI 能在賽局中取得最大勝率。

## 🌟 定位與應用考量

理解`蒙地卡羅樹搜尋`在 AI 領域中定位，有助於應用時考量適用情境與優化方向。

### ⚓🗺 定位

根據其演算法流程及數學原理，MCTS 的定位與運用如下述：

*  🔁😽🪄  [決策演算法](06-06-decision_making_algorithm.zh-hant)：MCTS作為通用決策演算法，透過 **模擬** 與 **回饋** 來選擇最佳行動序列
* 🔴🧐🧭 [指導型分析](06-03-analysis_prescriptive.zh-hant)：MCTS核心目標是「在多種可能行動中，找到最佳策略」，符合「不只分析現況，還直接給出行動建議」的指導型分析

若以[☸ AI 導向](05----ai_orientations.zh-hant)定位，MCTS的應用明顯落在：

* ☸🤖 [智能體／代理人導向](05-03-oriented_agent.zh-hant)：MCTS 賦予智能體在複雜環境中，能像人類般地進行深思熟慮與規劃的能力，使其能自主地做出最佳決策。
* ☸🛠 [任務導向型](05-01-oriented_task.zh-hant)：MCTS 專注於解決特定任務，例如規劃出圍棋對弈中的最佳棋步或機器人導航的最短路徑，以達成任務的最終目標。

然而，由於涉及**決策**，情境性脈絡應用會需要思量☸⚖️ [治理導向](05-05-oriented_governance.zh-hant) 及 ☸🏛️ [知識導向](05-01-oriented_knowledge.zh-hant)，以確保決策**品質及後果**。

### 📐🌉 應用考量

由於 MCTS 是種透過 **模擬** 與 **回饋** 來選擇最佳行動序列的**通用決策演算法**，可以運用**強化學習**及**深度學習**來進行優化，可以有以下思路：

* 🏮💪 [行為主義](02-06-behaviorism.zh-hant)的**強化學習**：
	* **策略由經驗累積**：決策品質取決於模擬經驗的大量統計，這與行為主義強調的「由外部刺激與回饋塑造行為」。 
	* **互動與回饋**：MCTS 的核心是「模擬—評估—回饋—更新」，它不需要事先學到一個完整的世界模型，而是透過不斷試探（simulation）和回饋（reward/score）來改進決策策略，這和強化學習的 trial-and-error 精神高度一致。
* 🏮🧬 [連結主義](02-05-connectionism.zh-hant)的**深度學習**：
	* **策略與價值評估網路**：可用深度神經網路（policy network / value network）來引導 MCTS 的模擬方向與節點評估，減少搜尋空間並提升決策效率（如 AlphaGo 案例）。
	* **混合式架構**：深度學習負責從大量資料中學得**啟發式評估函數**，MCTS 則負責在決策空間中進行策略探索，兩者形成閉環優化。

其中，由於策略是由經驗累積，此演算法**無需先驗知識**（舉例：不用精英棋手教下棋），但仍可運用其**漸進式改進**及**可擴展性**（如平行運算加速）的特性去進行**強化學習**及**深度學習**優化（舉例：可以從精英棋手的棋譜學習，也能和精英棋手對博，甚至機器自我互博來學習）。

***

## 🏁 小結及相關條目

是種驅動決策的 **[框架思維](01-04-Frame_Problem.zh-hant)**，`蒙地卡羅樹搜尋`（MCTS）方法，能整合賽局中的「**大格局觀**」與「**機會成本**」概念，廣泛應用於 [博弈](07----game_ai.zh-hant) 與自動化 AI 系統中，特別是[任務與目標規劃](08-06-robot_tasks_and_goals.zh-hant)。其「大格局觀」由**啟發式評估函數**體現，而「機會成本」則常由**UCT**公式體現，在「已知的好處」與「未知的可能性」之間取得平衡。

在 AI 領域內，MCTS 可以是[決策演算法](06-06-decision_making_algorithm.zh-hant)、[指導型分析](06-03-analysis_prescriptive.zh-hant)、等的可選工具，值得在[智能體／代理人導向](05-03-oriented_agent.zh-hant) 、[任務導向](05-01-oriented_task.zh-hant) 應用考量適用與否。同時，因為其決策的賽局機率特質，在設計或執行 [行為主義](02-06-behaviorism.zh-hant) 的 **強化學習**及 [連結主義](02-05-connectionism.zh-hant) 的 **深度學習** 時，需要思量 [治理導向](05-05-oriented_governance.zh-hant) 及 [知識導向](05-01-oriented_knowledge.zh-hant)，以確保決策**品質及後果**，以確保 [AI 對齊與控制問題](01-06-Alignment_Control_Problem.zh-hant.md) 的有效及合理應對。